{% include 'base.html' %} {% load static %} {% block content %}
<!--naa sa profile.css ang style gpamutang mostly-->
<link rel="stylesheet" href="{% static 'css/profile.css' %}" />


{% if user.is_authenticated %}
<div class="body">
  <!--modal para sa messages-->
  {% include 'OnlyPans/modals/messages_modal.html' %}
  <div class="profile">
    {% if is_own_profile %}
    <img src="{{ request.user.avatar.url }}" alt="Profile Picture" />
    {% else %}
    <img src="{{ user.avatar.url }}" alt="Profile Picture" />
    {% endif %}
    <div>
      <h1>{{ user.first_name }} {{ user.last_name }}</h1>
      
        <!--show sa following-->
        <p>
          <a> {% include 'OnlyPans/modals/follower_modal.html' %} {{ number_of_follower }} follower{% if number_of_follower > 1 %}s{% endif %} </a> Â· 
          {{ number_of_following }} following{% if number_of_following > 1 %}s{% endif %}
        </p>
      <!--show sa following-->
      <div class="followers_avatar">
      {% if follower %}
      {% for user in follower|slice:":6" %}
      <a href="{% url 'profile' user.follower.username %}">
        <img
          src="{{ user.follower.avatar.url }}"
          alt="{{ user.follower.username }}"
          class="follow_avatar"
        />
      </a>
      {% endfor %}
      {% endif %}
      </div>
      
    </div>

    <div class="buttons">
      {% if is_own_profile %}
      <button class="button" id="editProfileBtn">Edit</button>
      <!--EDIT PROFILE MODAL-->
      {% include 'OnlyPans/modals/edit_profile.html' %}
      {% else %}
      <form method="POST" action="{% url 'follow_user' username=user.username %}">
        {% csrf_token %}
        {% if is_following %}
          <button class="button" id="unfollowBtn">Unfollow</button>
        {% else %}
          <button class="button" id="followBtn">Follow</button>
        {% endif %}
      </form>
      {% endif %}
    </div>
  </div>
  <div class="body_content">
    <div class="sidebar">
      
      <p class="intro">Intro</p>
      <p></p><i class="fas fa-wifi" style="transform: rotate(50deg);"></i>Followed by <strong>{{ number_of_follower }} people</strong></p>
      <p><i class="fas fa-calendar-alt"></i>Joined on <strong>{{ user.date_joined|date:"F j, Y" }}</strong></p>
      {% if is_own_profile %}
      <div class="bio_container">
        <p class="bio_text">{{ user.bio }}</p>
        <button class="button edit_bio" id="editBioBtn">Edit bio</button>
        <!--EDIT BIO MODAL-->
        {% include 'OnlyPans/modals/edit_bio.html' %}
      </div>
      {% else %}
      <div class="bio_container">
        <p class="bio_text">{{ user.bio }}</p>
        <br />
      </div>
      {% endif %}
      <div class="followers_container">
        <div class="follower_header">
          
          <p class="follower_title">Follower{% if number_of_follower > 1 %}s{% endif %}</p>
          <p class="number_of_follower">{{ number_of_follower }} follower{% if number_of_follower > 1 %}s{% endif %}</p>
        </div>
        {% if follower %}
        
        <div class="followers">
          {% for user in follower %}
          <div class="follower_card">
            
            <a href="{% url 'profile' user.follower.username %}">
            <img
              src="{{ user.follower.avatar.url }}"
              alt="{{ user.follower.username }}"
              class="follower_picture"
            />
          </a>
            <p class="follower_name">{{ user.follower.last_name }}, {{ user.follower.first_name }}</p>           
          </div>
          {% endfor %}
          <div class="follower_card"></div>
          {% if number_of_follower == 0 %}
          <p class="number_of_follower">No follower</p> 
          {% endif %}

        </div>
        
        
        {% endif %}
      </div>
    </div>
    <!--end of sidebar-->

    <!--main content-->
    <div class="main_content">
      <!-- Create post modal -->
      {% if is_own_profile  %}
        {% include 'OnlyPans/modals/create_post.html' %}
      {% else %}
        <style>
          .post { margin: 0;}
        </style>
      {% endif %}
      <!-- Posts Container -->
      <div id="post-container">
        {% include 'OnlyPans/post.html' %}
      </div>
  
      <!-- Loading indicator -->
      <div id="loading" style="display: none;">Loading more posts...</div>
  </div>
  
  </div>
</div>
<!--scripts for showing the posts-->
<script>
  var username = "{{ user.username | escapejs }}";
</script>
<script src="{% static 'js/showposts.js' %}"></script>
{% endif %} {% endblock %}
